version: 2

models:
  - name: stg_eis__contract_stages
    description: "Стадия нормализации данных из fz44_contract_stages"
    columns:
      - name: externalSid
        description: "Внешний идентификатор этапа. При приеме контролируется уникальность номера в рамках документа"
        data_type: text
      - name: guid
        description: |
          GUID этапа контракта.
          Игнорируется при приеме, используется для электронного актирования
        data_type: text
      - name: startDate
        description: "Дата начала этапа"
        data_type: date
      - name: sid
        description: |
          Уникальный идентификатор этапа контракта в ЕИС. 
          Назначается один раз при сохранении версии документа, в которой добавлен этап, не меняется в следующих версиях.
          Игнорируется при приеме
        data_type: int8
      - name: endDate
        description: "Дата окончания исполнения этапа"
        data_type: date
      - name: externalSid
        description: "Внешний идентификатор этапа. При приеме контролируется уникальность номера в рамках документа"
        data_type: text
      - name: guid
        description: |
          GUID этапа контракта.
          Игнорируется при приеме, используется для электронного актирования
        data_type: text
      - name: startDate
        description: "Дата начала исполнения этапа"
        data_type: date
      - name: sid
        description: |
          Уникальный идентификатор этапа контракта в ЕИС.
          Назначается один раз при сохранении версии документа, в которой добавлен этап, не меняется в следующих версиях.
          Игнорируется при приеме
        data_type: int8
      - name: endDate
        description: "Дата окончания исполнения этапа"
        data_type: date
      - name: externalSid
        description: |
          Внешний идентификатор этапа. 
          
          При приеме первой версии контролируется обязательность заполнения для сведений о контракте, первая версия которого была размещена после выхода версии 13.2
          При приеме второй и последующих версий контролируется заполненность sid или/и externalSid в блоке stage для сведений о контракте, первая версия которого была размещена после выхода версии 13.2
          
          Контролируется, что этап с указанным externalSid присутствует в блоке \"Этапы исполнения контракта\" (executionPeriod/stages)
          
          В случае, если установлен признак isElectronicContractExternalSid, при приеме проекта первоначальной версии, сформированного на основании электронного контракта в структурированном виде, заполняется внешним идентификатором из структурированного контракта
        data_type: text
      - name: guid
        description: |
          GUID этапа контракта.
          Игнорируется при приеме, используется для электронного актирования
        data_type: text
      - name: startDate
        description: "Дата начала исполнения этапа"
        data_type: date
      - name: sid
        description: |
          Уникальный идентификатор этапа контракта в ЕИС. 
          
          Игнорируется при приеме первой версии сведений о контракте. 
          При приеме второй и последующих версий контролируется заполненность sid или/и externalSid в блоке stages для сведений о контракте, первая версия которого была размещена после выхода версии 13.2
          
          Контролируется, что этап с указанным sid присутствует в блоке \"Этапы исполнения контракта\" (executionPeriod/stages)
        data_type: int8
      - name: electronicContractExternalSid
        description: |
          Внешний идентификатор этапа исполнения контракта в электронном контракте.
          
          Игнорируется при приеме, заполняется автоматически в случае, если этап был автоматически наследован из электронного контракта
        data_type: text
      - name: electronicContractSid
        description: |
          Уникальный идентификатор этапа исполнения контракта в электронном контракте.
          
          Игнорируется при приеме, заполняется автоматически в случае, если этап был автоматически наследован из электронного контракта
        data_type: int8
      - name: endDate
        description: |
          Дата окончания исполнения этапа.
          
          По данному полю не осуществляется привязка к этапу в блоке \"Этапы исполнения контракта\" (executionPeriod/stages) сведений о контракте, первая версия которых была размещена после выхода версии 13.2
        data_type: date
      - name: sid
        description: |
          Уникальный идентификатор этапа контракта в ЕИС. 
          
          Игнорируется при приеме первой версии сведений о контракте. Назначается в ЕИС и заполняется при передаче первой версии.
          Назначается один раз при сохранении версии документа, в которой добавлен этап, не меняется в следующих версиях.
          
          При приеме последующих версий используется для идентификации этапа исполнения контракта в разных версиях сведений о контракте. 
          При приеме изменений сведений о контракте, если поле заполнено, то контролируется, что в предыдущей версии сведений о контракте найден этап исполнения контракта с указанным значением sid
          
          При приеме второй и последующих версий контролируется заполненность sid или/и externalSid в блоке stage для сведений о контракте, первая версия которого была размещена после выхода версии 13.2
        data_type: int8
      - name: externalSid
        description: |
          Внешний идентификатор этапа. 
          
          При приеме контролируется уникальность номера в рамках документа
          
          При приеме первой версии контролируется обязательность заполнения для сведений о контракте, первая версия которого была размещена после выхода версии 13.2
          
          При приеме второй и последующих версий контролируется заполненность sid или/и externalSid в блоке stage для сведений о контракте, первая версия которого была размещена после выхода версии 13.2.
          
          В случае, если установлен признак isElectronicContractExternalSid, при приеме проекта первоначальной версии, сформированного на основании электронного контракта в структурированном виде, заполняется внешним идентификатором из структурированного контракта
        data_type: text
      - name: electronicContractSid
        description: |
          Уникальный идентификатор этапа исполнения контракта в электронном контракте.
          
          Игнорируется при приеме, заполняется автоматически в случае, если этап был автоматически наследован из электронного контракта.
          Если заполнено поле \"Наименование этапа\" (stageName), то принимается и сохраняется
        data_type: int8
      - name: electronicContractExternalSid
        description: |
          Внешний идентификатор этапа исполнения контракта в электронном контракте.
          
          Игнорируется при приеме, заполняется автоматически в случае, если этап был автоматически наследован из электронного контракта.
          Если заполнено поле \"Наименование этапа\" (stageName), то принимается и сохраняется
        data_type: text
      - name: guid
        description: |
          GUID этапа контракта.
          Игнорируется при приеме, используется для электронного актирования
        data_type: text
      - name: startDate
        description: "Дата начала исполнения этапа"
        data_type: date
      - name: endDate
        description: |
          Дата окончания исполнения этапа.
          
          По данному полю не осуществляется привязка к этапу в сведениях о контракте, первая версия которого была размещена после выхода версии 13.2
        data_type: date
      - name: stageName
        description: "Наименование этапа"
        data_type: text
      - name: stagePrice
        description: |
          Цена этапа контракта в валюте контракта. 
          Игнорируется при приеме в случае указания только одного блока executionPeriod/stages
        data_type: text
      - name: stagePriceRUR
        description: "Цена этапа контракта в российских рублях. Игнорируется при приеме.  Заполняется при передаче, в случае если валюта контракта отлична от рублей"
        data_type: text
      - name: sumInPercents
        description: |
          Размер аванса в процентах. 
          Если заполнено поле priceValue, то значение поля игнорируется при приеме, рассчитывается автоматически sumInPercents = (priceValue*100)/ stagePrice. Результат округляется до 2-х знаков после запятой по правилам математического округления
        data_type: text
      - name: priceValue
        description: |
          Размер аванса в валюте контракта. 
          Если заполнено поле sumInPercents, то значение поля игнорируется при приеме, рассчитывается автоматически priceValue =  stagePrice*(sumInPercents/100). Результат округляется до 2-х знаков после запятой по математическим правилам
        data_type: text
      - name: priceValueRUR
        description: "Размер аванса в рублевом эквиваленте. При приеме игнорируется, заполняется при передаче в случае если валюта контракта отлична от рублей"
        data_type: text
